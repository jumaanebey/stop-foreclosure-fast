<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Email System Tester - My Foreclosure Solution</title>
    <style>
        body {
            font-family: 'Inter', -apple-system, sans-serif;
            max-width: 800px;
            margin: 40px auto;
            padding: 20px;
            background: linear-gradient(135deg, #fef3e2, #fff8f3);
            min-height: 100vh;
        }
        .container {
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        h1 {
            color: #dc2626;
            margin-bottom: 30px;
        }
        .test-section {
            background: #f9fafb;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border: 2px solid #e5e7eb;
        }
        input, select {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            border: 2px solid #fed7aa;
            border-radius: 8px;
            font-size: 16px;
        }
        button {
            background: linear-gradient(135deg, #dc2626, #991b1b);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            margin: 10px 0;
            width: 100%;
        }
        button:hover {
            opacity: 0.9;
        }
        .status {
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            display: none;
        }
        .status.success {
            background: #d1fae5;
            color: #065f46;
            border: 2px solid #10b981;
            display: block;
        }
        .status.error {
            background: #fee2e2;
            color: #991b1b;
            border: 2px solid #dc2626;
            display: block;
        }
        .status.info {
            background: #dbeafe;
            color: #1e40af;
            border: 2px solid #3b82f6;
            display: block;
        }
        .checklist {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        .checklist h3 {
            color: #7c2d12;
            margin-bottom: 15px;
        }
        .checklist-item {
            padding: 10px 0;
            border-bottom: 1px solid #e5e7eb;
        }
        .checklist-item:last-child {
            border: none;
        }
        .result {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 14px;
            font-weight: 600;
        }
        .result.pending {
            background: #fef3c7;
            color: #92400e;
        }
        .result.success {
            background: #d1fae5;
            color: #065f46;
        }
        .result.error {
            background: #fee2e2;
            color: #991b1b;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ Email System Test Dashboard</h1>

        <div class="test-section">
            <h2>üìù Configuration</h2>
            <p>First, enter your Google Apps Script Web App URL:</p>
            <input type="text" id="webAppUrl" placeholder="https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec">
            <button onclick="saveConfig()">Save Configuration</button>
            <div id="configStatus" class="status"></div>
        </div>

        <div class="test-section">
            <h2>üöÄ Test 1: Lead Magnet (PDF Guide)</h2>
            <p>This will test if the PDF email is sent automatically.</p>
            <input type="text" id="test1Name" placeholder="Test Name" value="Test User">
            <input type="email" id="test1Email" placeholder="your-email@example.com">
            <button onclick="testLeadMagnet()">Send Test Lead Magnet</button>
            <div id="test1Status" class="status"></div>
        </div>

        <div class="test-section">
            <h2>üìû Test 2: Consultation Request</h2>
            <p>This will test the consultation confirmation email.</p>
            <input type="text" id="test2Name" placeholder="Test Name" value="Emergency Test">
            <input type="email" id="test2Email" placeholder="your-email@example.com">
            <input type="tel" id="test2Phone" placeholder="(555) 555-5555">
            <select id="test2Timeline">
                <option value="emergency">EMERGENCY - Sale within 30 days</option>
                <option value="1-3-months">1-3 months behind</option>
                <option value="exploring-options">Just exploring options</option>
            </select>
            <button onclick="testConsultation()">Send Test Consultation</button>
            <div id="test2Status" class="status"></div>
        </div>

        <div class="checklist">
            <h3>‚úÖ Testing Checklist</h3>
            <div class="checklist-item">
                1. Google Apps Script URL configured: <span id="check1" class="result pending">Pending</span>
            </div>
            <div class="checklist-item">
                2. Lead magnet test sent: <span id="check2" class="result pending">Pending</span>
            </div>
            <div class="checklist-item">
                3. PDF email received: <span id="check3" class="result pending">Check email</span>
            </div>
            <div class="checklist-item">
                4. Consultation test sent: <span id="check4" class="result pending">Pending</span>
            </div>
            <div class="checklist-item">
                5. Confirmation email received: <span id="check5" class="result pending">Check email</span>
            </div>
            <div class="checklist-item">
                6. Data in Google Sheet: <span id="check6" class="result pending">Check sheet</span>
            </div>
            <div class="checklist-item">
                7. Notification emails received: <span id="check7" class="result pending">Check email</span>
            </div>
        </div>

        <div class="test-section" style="background: #fef3e2; border-color: #fed7aa;">
            <h2>üìä What to Check After Testing:</h2>
            <ol>
                <li><strong>Your Email Inbox:</strong> You should receive:
                    <ul>
                        <li>PDF guide email (with attachment) for lead magnet test</li>
                        <li>Consultation confirmation email</li>
                        <li>Notification emails about new leads</li>
                    </ul>
                </li>
                <li><strong>Your Google Sheet:</strong> Should have new rows with test data</li>
                <li><strong>Google Apps Script Logs:</strong> Check View ‚Üí Logs for any errors</li>
            </ol>
        </div>
    </div>

    <script>
        // Load saved configuration
        window.onload = function() {
            const defaultUrl = 'https://script.google.com/macros/s/AKfycbyDfXcPynNdIaDhWHO3nprBBX2hmL7F0dHjiV4K9nvYW_8gQieUhhayOvlO5vS9YW-c/exec';
            const savedUrl = localStorage.getItem('webAppUrl') || defaultUrl;
            document.getElementById('webAppUrl').value = savedUrl;
            if (savedUrl) {
                localStorage.setItem('webAppUrl', savedUrl);
                document.getElementById('check1').textContent = 'Configured';
                document.getElementById('check1').className = 'result success';
            }
        };

        function saveConfig() {
            const url = document.getElementById('webAppUrl').value;
            if (!url) {
                showStatus('configStatus', 'Please enter your Web App URL', 'error');
                return;
            }
            localStorage.setItem('webAppUrl', url);
            showStatus('configStatus', '‚úÖ Configuration saved!', 'success');
            document.getElementById('check1').textContent = 'Configured';
            document.getElementById('check1').className = 'result success';
        }

        function testLeadMagnet() {
            const url = localStorage.getItem('webAppUrl');
            if (!url) {
                showStatus('test1Status', 'Please configure your Web App URL first', 'error');
                return;
            }

            const name = document.getElementById('test1Name').value;
            const email = document.getElementById('test1Email').value;

            if (!name || !email) {
                showStatus('test1Status', 'Please fill in all fields', 'error');
                return;
            }

            const data = {
                type: 'lead_magnet',
                name: name,
                email: email,
                source: 'test-dashboard',
                timestamp: new Date().toISOString()
            };

            showStatus('test1Status', 'üì§ Sending test...', 'info');

            fetch(url, {
                method: 'POST',
                mode: 'no-cors',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            }).then(() => {
                showStatus('test1Status', '‚úÖ Test sent! Check your email for the PDF guide.', 'success');
                document.getElementById('check2').textContent = 'Sent';
                document.getElementById('check2').className = 'result success';
                document.getElementById('check3').textContent = 'Check now';
                document.getElementById('check3').className = 'result info';
            }).catch(error => {
                showStatus('test1Status', '‚ùå Error: ' + error.message, 'error');
                document.getElementById('check2').textContent = 'Failed';
                document.getElementById('check2').className = 'result error';
            });
        }

        function testConsultation() {
            const url = localStorage.getItem('webAppUrl');
            if (!url) {
                showStatus('test2Status', 'Please configure your Web App URL first', 'error');
                return;
            }

            const name = document.getElementById('test2Name').value;
            const email = document.getElementById('test2Email').value;
            const phone = document.getElementById('test2Phone').value;
            const timeline = document.getElementById('test2Timeline').value;

            if (!name || !email || !phone) {
                showStatus('test2Status', 'Please fill in all fields', 'error');
                return;
            }

            const data = {
                type: 'consultation',
                name: name,
                email: email,
                phone: phone,
                timeline: timeline,
                situation: 'Test consultation request from dashboard',
                preferred_contact: 'phone',
                source: 'test-dashboard',
                timestamp: new Date().toISOString()
            };

            showStatus('test2Status', 'üì§ Sending test...', 'info');

            fetch(url, {
                method: 'POST',
                mode: 'no-cors',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            }).then(() => {
                showStatus('test2Status', '‚úÖ Test sent! Check your email for confirmation.', 'success');
                document.getElementById('check4').textContent = 'Sent';
                document.getElementById('check4').className = 'result success';
                document.getElementById('check5').textContent = 'Check now';
                document.getElementById('check5').className = 'result info';
                document.getElementById('check6').textContent = 'Check sheet';
                document.getElementById('check6').className = 'result info';
                document.getElementById('check7').textContent = 'Check email';
                document.getElementById('check7').className = 'result info';
            }).catch(error => {
                showStatus('test2Status', '‚ùå Error: ' + error.message, 'error');
                document.getElementById('check4').textContent = 'Failed';
                document.getElementById('check4').className = 'result error';
            });
        }

        function showStatus(elementId, message, type) {
            const element = document.getElementById(elementId);
            element.textContent = message;
            element.className = 'status ' + type;
        }
    </script>
</body>
</html>